<ng-template #content let-modal>
  <form [formGroup]="userForm" novalidate>
  <div class="modal-header">

    <h4 *ngIf="userForm.value._id; else elseTitle" class="modal-title">Edit user<span class="badge badge-secondary ml-2">New</span></h4>
    <ng-template #elseTitle>
      <h4 class="modal-title">Add a new user<span class="badge badge-secondary ml-2">New</span></h4>
    </ng-template>

    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">

  <div class="form-group">
    <label for="emailForm">Email</label>
    <input  type="email"
            class="form-control"
            id="emailForm"
            autocomplete="off"
            formControlName="email"
            name="emailForm"
            [class.is-invalid]="userForm.controls['email'].invalid && userForm.controls['email'].touched"
            [class.is-valid]="userForm.controls['email'].valid && userForm.controls['email'].touched">
  </div>

  <div class="form-group">
    <label for="usernameForm">Username</label>
    <input  type="text"
            class="form-control"
            id="usernameForm"
            autocomplete="off"
            formControlName="username"
            name="usernameForm"
            [class.is-invalid]="userForm.controls['username'].invalid && userForm.controls['username'].touched"
            [class.is-valid]="userForm.controls['username'].valid && userForm.controls['username'].touched">
  </div>

  <div class="form-group" *ngIf="!userForm.value._id">
    <label for="passwordForm">Password</label>
    <input  type="password" 
            class="form-control"
            id="passwordForm"
            autocomplete="off"
            formControlName="password"
            name="passwordForm"
            aria-describedby="passwordHelp"
            [class.is-invalid]="userForm.controls['password'].invalid && userForm.controls['password'].touched"
            [class.is-valid]="userForm.controls['password'].valid && userForm.controls['password'].touched">
    <small id="passwordHelp" class="form-text text-muted">Enter a password of the username or its full name</small>
  </div>

  <div class="form-group">
    <label for="firstNameForm">Name</label>
    <input  type="text"
            class="form-control"
            id="firstNameForm"
            autocomplete="off"
            formControlName="firstName"
            name="firstNameForm"
            [class.is-invalid]="userForm.controls['firstName'].invalid && userForm.controls['firstName'].touched"
            [class.is-valid]="userForm.controls['firstName'].valid && userForm.controls['firstName'].touched">
  </div>

  <div class="form-group">
    <label for="lastNameForm">Surname</label>
    <input  type="text"
            class="form-control"
            id="lastNameForm"
            autocomplete="off"
            formControlName="lastName"
            name="lastNameForm"
            [class.is-invalid]="userForm.controls['lastName'].invalid && userForm.controls['lastName'].touched"
            [class.is-valid]="userForm.controls['lastName'].valid && userForm.controls['lastName'].touched">
  </div>

  <div class="form-group">
    <label for="birthDateForm">Birth date</label>
    <div class="input-group">
      <input  type="text"
              class="form-control"
              id="birthDateForm"
              autocomplete="off"
              formControlName="birthDate"
              name="birthDateForm"
              [minDate]="{ year: date.getFullYear()-100, month: 1, day: 1 }"
              [maxDate]="{ year: date.getFullYear(), month: 12, day: 31 }"
              ngbDatepicker
              #d="ngbDatepicker"
              [class.is-invalid]="userForm.controls['birthDate'].invalid && userForm.controls['birthDate'].dirty"
              [class.is-valid]="userForm.controls['birthDate'].valid && userForm.controls['birthDate'].dirty">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button"><i class="fa fa-calendar" aria-hidden="true"></i></button>
      </div>
    </div>
  </div>
  
</div>
  <div class="modal-footer">
    <button *ngIf="userForm.value._id; else elseButton" [disabled]="sendLoading || userForm.invalid" type="button" class="btn btn-theme-primary" (click)="sendData()">
      <span *ngIf="sendLoading">Editing...</span>
      <span *ngIf="!sendLoading">Edit</span>
    </button>
    <ng-template #elseButton>
      <button [disabled]="sendLoading || userForm.invalid" type="button" class="btn btn-theme-primary" (click)="sendData()">
        <span *ngIf="sendLoading">Creating...</span>
        <span *ngIf="!sendLoading">Create</span>
      </button>
    </ng-template>
    <button type="button" ngbAutofocus class="btn btn-secondary" (click)="modal.close('Close click')">Close</button>
  </div>
</form>
</ng-template>